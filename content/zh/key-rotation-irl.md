---
title: 如何更新你的（资格）证书（记一次更新过程的逻辑缺陷）
date: 2025-07-15
slug: key-rotation-irl
author: HtwoO
categories:
    - 技术
tags:
    - 数字签名
    - 信息安全
    - 公共服务
---

前一阵子，我改了自己名字里的一个字，整个流程还算简单，办事前一天电话咨询，当天准备齐全各项资料，到公安局的户政科，现场办事的人不多，在现场手写申请表，之后工作人员走流程过程大概花费了一个小时。过程中工作人员没有表现出不耐烦，体验比几年前好不少，几年前我去询问这个事情的时候，现场工作人员劈头盖脸的就问我为什么要改，说改名字会造成很多麻烦。当天户口簿的信息就更新了（实际上换了一本），新的身份证我选的邮寄，过了两天多也拿到了。

## 更新商事实体登记信息

本文记录一下改名之后我更新自己注册的一个实体信息的过程。整个过程最麻烦的其实是找到流程的入口，以及电子签名和实名验证过程，只是更新名字里的一个字，更新的信息并不多。

一开始我以为是在平时我开发票经常登录的电子税务局更新，后来才知道是应该在注册实体的地方，但我记得注册实体的网页链接很奇怪，过程中填写经营范围时又链接了一个「[经营范围规范表述查询系统（试用版）](https://jyfwyun.com/)」，这个好像不需要更新什么。

流程入口菜单层级：打开[广西数字政务一体化平台](https://zwfw.gxzf.gov.cn/)，往下滚动，「市场监管准入一体化平台」在页面左侧，可以用浏览器的页面文字搜索功能，搜索「市场监管」，可以快速找到入口。
办事过程中我记录的直链：[广西市场监管准入一体化平台（试运行）](https://wxxcx.zwfw.gxzf.gov.cn/jmopen1/webapp/html5/companySetup/)，这里面有新办、注销等业务流程，进入「企业变更“一件事” -> 办件中心」菜单，这里就是变更实体信息的流程入口了，这里有「我的办件、我的签名和我代理的经营主体」三个标签页。

「我的办件」页面上，还能看到当初申请开办这个实体时的记录。以下是在「我的办件」页面复制出来的本次流程元数据记录，我替换了一些信息，调整了一些文字的排版方式。以下文字中的「甘道夫」是我，「诸葛亮」是市场监督管理所实际受理我这个办件（云帮办）的具体工作人员。实际排序方式和下面段落一样，就是页面上方的文字较新，页面底下的比较旧。感觉有些违反逻辑，不知道决定前端页面样式的工作人员是怎么考虑的。

```
2025-07-08 09:02:17
云帮办
办理人： 诸葛亮
办理机关： xx 市 yy 区 zz 市场监督管理所
审核意见： 由 xx 市 yy 区市场监督管理局的诸葛亮云帮办通过！审核意见：将营业执照邮寄(只接受邮政或顺丰上门派件）或现场交回 zz 市场监管所，地址： xx 市 yy 区 ... 市场监督管理所。
电话： 01234567 ，收件人：前台，营业执照收到后，再进入审核环节。
2025-07-07 21:43:42
申请
办理人：甘道夫
2025-07-07 21:39:53
申请人修改
办理人：甘道夫
2025-07-07 16:55:17
云帮办
办理人：诸葛亮
办理机关： xx 市 yy 区 zz 市场监督管理所
审核意见： 由 xx 市 yy 区市场监督管理局的诸葛亮云帮办不通过请修改再次提交！退回原因：联络员姓名也需要变更。修改后再重新提交
2025-07-07 16:41:15
申请
办理人：甘道夫
2025-07-07 16:11:21
申请人修改
办理人：甘道夫
2025-07-07 11:15:46
云帮办
办理人：诸葛亮
办理机关： xx 市 yy 区 zz 市场监督管理所
审核意见： 由 xx 市 yy 区市场监督管理局的诸葛亮云帮办不通过请修改再次提交！退回原因：姓名变更，联络员也需要变更。修改后再重新提交，将营业执照邮寄(只接受邮政或顺丰上门派件）或现场交回 zz 市场监管所，地址： xx 市 yy 区市场监督管理所。
电话：01234567，收件人：前台，营业执照收到后，再进入审核环节。
2025-07-02 17:44:15
申请
办理人：甘道夫
```

之前没走过这个流程，不知道更新经营者信息后，还有个联络员信息也要更新。 7 月 2 日提交申请后，到 7 日 11 点多收到需要退回补正的短信，上面文字也有那条提醒。第一次补正的时候，我没仔细看信息，只看到系统（从经营者变更提交的资料里取得？并）自动填入的身份证照片资料正确，没注意到它自动填入的名字还是旧的，那次提交后大概半小时就收到反馈了，当天晚上我重新登录上去才发现问题。修改重新提交后，第二天审核通过，然后收到短信提醒，需要「签名后提交」。登录系统后，在变更经营者名字的流程条目右侧，能看到「签名」按钮，还有一个条目，是更新联络员信息的，好像按钮叫「认证」，两个按钮点击后，均会出现「登记注册身份验证」的二维码，可以用支付宝扫码继续验证步骤，应该也可以用同名的应用作身份验证，但我用该应用扫码后，看到需要注册帐号，需要提供很多信息，然后还是图省事选择用支付宝来扫码验证。

### 使用实名验证的帐号刷脸和手写签名给元数据签名
支付宝扫码后，身份验证程序的登录页面上，自动填了旧的名字，勾选必需的选项后，会要求扫脸验证，验证完成后，有个「查看待办事项」按钮，点击后没看到有内容，也没见跳转。然后我打了「我的办件」页面上显示的电话号码询问情况，他们说是要登录新名字的（帐号？）验证，才能看到待办事项。由于之前我没在支付宝上传过身份证照片，认证过程有一步要求上传身份证正反面照片，但我上传新身份证照片、填写新名字后似乎登录不了，错误信息好像是身份信息不匹配，（记不得了）。电话继续询问之后，工作人员表示新名字的（帐号？）信息需要在支付宝修改。当时我还质疑了一下，为什么这个信息由支付宝（存储？和）维护？他们只是说就是要在支付宝更新的。

### 更新支付宝实名信息
然后我找了一下，找到了支付宝「更新姓名或证件号码」功能的页面，点进去之后，需要上传身份证照片完善资料（和刷脸认证？），完成后，看到了「身份信息已完善」页面，然后看到支付宝实名信息确实更新了。这时再尝试在身份验证（小）程序登录，可以直接登录上去，并且点击登录后出现的「查看待办事项」后能看到待办事项。然后又是扫脸认证、签名，好像操作了两次还是三次。之后再去「市场监管准入一体化平台 -> 企业变更“一件事”」页面，可以看到经营者变更的流程条目变成「已签名」（具体文字好像不是这个）状态，联络员变更的流程条目则出现了蓝色的「已认证」三个字。

### 仍然缺少一个电子签名——旧证签的名
这时，我以为流程在我自己这端需要的步骤都完成了，就又打了一次流程详情里的电话号码，询问我这边是否还需要做什么，他们说还需要签名和提交，令我有些疑惑，我不是刚签名了么？工作人员还说需要我把旧营业执照送回市场监督管理所，才可以继续后续的审核流程。挂了电话后，我又刷新了一下「我的办件」页面，看到流程条目右边有个「资料 XY 」链接，我点进去后，发现还有个签名按钮，并且页面上显示是旧的名字，点击「签名」按钮后，又出现了支付宝「登记注册身份验证」程序的界面，我就又刷脸验证了一次，刷完后，点击「查看待办事项」，发现没有什么我能做的操作。考虑到我需要把旧营业执照送过去，并且认为如果还需要提供签名，在线下办公点应该也可以签，所以我就没继续查看在线流程能做什么了。

第二天，我带上旧的营业执照以及副本前往市场监督管理所，在现场把用旧证给元数据变更签名的流程给工作人员演示了一下，表示那个在线流程我这边已经做不了什么操作了，工作人员直接跟我说，既然我已经到那里了，不如直接就线下办理好了，并且填好资料后需要删除之前线上发起的流程。

然后我又手写了几个表格，期间还有个工作人员，帮我查验了填写的信息，确保提交的资料齐全并且格式符合要求，还要去旁边的小店复印了三份身份证复印件。填完资料后，我还得重新取号，还好现场办事的人不算多。提交资料后，其实也需要在工作人员提醒的时机，用支付宝的「等级注册身份验证」程序来刷脸做实名认证，并提供手写签名，但这次好像没有要求提供使用旧的实名帐号签的名。不过工作人员办事设备端上，似乎也还能看到使用旧证签名的选项，只不过估计是可选的。

之后他们说新的营业执照第二天可以拿到，但第二天我没空过去，他们只是表示他们不负责保管，让我尽快找时间去领取。我还询问了是否可以邮寄，工作人员没有肯定回答，隔天我才去领取了新的执照。领取当天，我还询问了一下能否只用电子执照，不用纸质的，他们表示不可以。

## 回顾办事流程的业务逻辑缺陷

熟悉计算机（安全）技术的人，看到这个流程，应该很容易发现它和公钥加密体系里的证书更新几乎是一样的。只是常见的 GnuPG 或 PGP 证书更新，一般都是在旧的证书快过期时发起的，更新的最主要元数据就是证书有效期。证书里其他的（邮箱、昵称等）元数据，由于基本上是使用者自己选择的，需要更新的机会可能反而不多。

典型的 GnuPG 证书更新过程，是一种交叉签名，相当于在正式使用新的（证书）信息之前：
 - 用旧的仍然有效的私钥给新的信息签名，这相当于把旧的信任链传递给新的证书
 - 用新的私钥给旧的密钥做数字签名，这一步我感觉不是必需的
 - 发布到公钥服务器，让数据使用方知道这个变更
 - 撤回 (Revoke) 旧的密钥对，令其失效

在具体的营业执照改名这个流程中，有个流程设计上的缺陷，导致我未能做到能在线办的就尽量在线办理。假如经营者名称是从「张三」改成「李四」，需要先让「张三」登录「登记注册身份验证」程序，然后更新要修改的信息，在待修改信息得到确认之后，使用「张三」的密钥给修改（或修改后）的信息做电子签名；修改之后，再使用「李四」的帐号登录「登记注册身份验证」程序，给新的信息做电子签名。实际的在线流程中，我**发起信息变更申请，市场监督管理所工作人员审核通过之后，我用旧的名字登录「登记注册身份验证」程序，应该有个类似「数据变更（电子）签名」的待办事项才对，但我办理的时候没有**；更新支付宝实名信息，并用新名字登录「登记注册身份验证」程序后，有待办事项，但用这个**新的实名帐号签名后，理论上旧的实名帐号就失效，不能再拿来做签名了**。

另一种交叉签名验证方式是由第三方（在本例中就是「市场监督管理所」）给资料的变更做电子签名，这个实际上应该就是我在现场办理的流程中所使用的验证方式。

实际的这个验证流程中，每个签名所使用的私钥存在哪里我并不是很清楚，所以有些地方我写成了「密钥」，我的猜测是：在验证所用的应用中被要求刷脸并验证通过后，私钥的数据才被解密了，做完电子签名后会被重新加密和存储。

## 流程中其他需要改进的地方

 - 提交申请后，没有反馈，对大概要等待多久没有预期，只能盲等；
 - 没有一个容易查询到、明显的流程入口，一些过程中的流程跳转到了 xxx.gxzf.gov.cn:9087 这样的地址，似乎政务服务渠道方为了避开（繁琐的）备案流程而没有使用标准的 HTTP(S) 端口，还有个链接直接就是 http://116.252.25.12:10121/... 这样的地址；
 - 政务服务流程文档非常稀缺，偶尔查到一些还是很旧的，还有一些公共服务提供方是通过把办事人拉到微信群里，由具体工作人员进行答疑；不少流程中必须填写的项目，有哪些选可项没有列出来，所以就需要通过询问工作人员来得知，什么时候这些公共服务部门的文档能更完善呢？
 - （在线）办理流程需要的资料文档有很多描述不齐全，还有些搜索到的不同地方政府要求的文档不一致
 - 一些常见流程没有电子版的模板，有一些有模板，但对填写的数据应符合什么格式不够明确。

